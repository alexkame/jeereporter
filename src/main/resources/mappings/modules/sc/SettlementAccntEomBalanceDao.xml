<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thinkgem.sc.accntemobalance.dao.SettlementAccntEomBalanceDao">
    
	<sql id="settlementAccntEomBalanceColumns">
		a.id AS "id",
		a.accountid AS "accountid",
		a.accountname AS "accountname",
		a.hotelid AS "hotelid",
		a.hotelname AS "hotelname",
		a.hotelpms AS "hotelpms",
		a.password AS "password",
		a.accountstate AS "accountstate",
		a.frozendate AS "frozendate",
		a.unfrozendate AS "unfrozendate",
		a.balance AS "balance",
		a.create_time AS "createTime",
		a.update_time AS "updateTime",
		a.accountrole AS "accountrole",
		a.waitpayment AS "waitpayment",
		a.postpay_balance AS "postpayBalance",
		a.postpay_threshold AS "postpayThreshold",
		a.accounttype AS "accounttype",
		a.year AS "year",
		a.month AS "month"
	</sql>
	
	<sql id="settlementAccntEomBalanceJoins">
	</sql>
    
	<select id="get" resultType="SettlementAccntEomBalance">
		SELECT 
			<include refid="settlementAccntEomBalanceColumns"/>
		FROM settlement_accnt_eom_balance a
		<include refid="settlementAccntEomBalanceJoins"/>
		WHERE a.id = #{id}
	</select>
	
	<select id="findList" resultType="SettlementAccntEomBalance">
		SELECT 
			<include refid="settlementAccntEomBalanceColumns"/>
		FROM settlement_accnt_eom_balance a
		<include refid="settlementAccntEomBalanceJoins"/>
		<where>
			
			<if test="id != null and id != ''">
				AND a.id = #{id}
			</if>
			<if test="accountid != null and accountid != ''">
				AND a.accountid = #{accountid}
			</if>
			<if test="accountname != null and accountname != ''">
				AND a.accountname LIKE 
					<if test="dbName == 'oracle'">'%'||#{accountname}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{accountname}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{accountname},'%')</if>
			</if>
			<if test="hotelid != null and hotelid != ''">
				AND a.hotelid = #{hotelid}
			</if>
			<if test="hotelname != null and hotelname != ''">
				AND a.hotelname LIKE 
					<if test="dbName == 'oracle'">'%'||#{hotelname}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{hotelname}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{hotelname},'%')</if>
			</if>
			<if test="hotelpms != null and hotelpms != ''">
				AND a.hotelpms = #{hotelpms}
			</if>
			<if test="password != null and password != ''">
				AND a.password = #{password}
			</if>
			<if test="accountstate != null and accountstate != ''">
				AND a.accountstate = #{accountstate}
			</if>
			<if test="frozendate != null and frozendate != ''">
				AND a.frozendate = #{frozendate}
			</if>
			<if test="unfrozendate != null and unfrozendate != ''">
				AND a.unfrozendate = #{unfrozendate}
			</if>
			<if test="beginBalance != null and beginBalance != ''">
				AND a.balance <![CDATA[>=]]> #{beginBalance}
			</if>
			<if test="endBalance != null and endBalance != ''">
				AND a.balance <![CDATA[<]]> #{endBalance}
			</if>
			<if test="beginCreateTime != null and beginCreateTime != ''">
				AND a.create_time <![CDATA[>=]]> #{beginCreateTime}
			</if>
			<if test="endCreateTime != null and endCreateTime != ''">
				AND a.create_time <![CDATA[<]]> #{endCreateTime}
			</if>
			<if test="updateTime != null and updateTime != ''">
				AND a.update_time = #{updateTime}
			</if>
			<if test="accountrole != null and accountrole != ''">
				AND a.accountrole = #{accountrole}
			</if>
			<if test="waitpayment != null and waitpayment != ''">
				AND a.waitpayment = #{waitpayment}
			</if>
			<if test="postpayBalance != null and postpayBalance != ''">
				AND a.postpay_balance = #{postpayBalance}
			</if>
			<if test="postpayThreshold != null and postpayThreshold != ''">
				AND a.postpay_threshold = #{postpayThreshold}
			</if>
			<if test="accounttype != null and accounttype != ''">
				AND a.accounttype = #{accounttype}
			</if>
			<if test="year != null and year != ''">
				AND a.year = #{year}
			</if>
			<if test="month != null and month != ''">
				AND a.month = #{month}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<select id="findAllList" resultType="SettlementAccntEomBalance">
		SELECT 
			<include refid="settlementAccntEomBalanceColumns"/>
		FROM settlement_accnt_eom_balance a
		<include refid="settlementAccntEomBalanceJoins"/>
		<where>
			
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO settlement_accnt_eom_balance(
			id,
			accountid,
			accountname,
			hotelid,
			hotelname,
			hotelpms,
			password,
			accountstate,
			frozendate,
			unfrozendate,
			balance,
			create_time,
			update_time,
			accountrole,
			waitpayment,
			postpay_balance,
			postpay_threshold,
			accounttype,
			year,
			month
		) VALUES (
			#{id},
			#{accountid},
			#{accountname},
			#{hotelid},
			#{hotelname},
			#{hotelpms},
			#{password},
			#{accountstate},
			#{frozendate},
			#{unfrozendate},
			#{balance},
			#{createTime},
			#{updateTime},
			#{accountrole},
			#{waitpayment},
			#{postpayBalance},
			#{postpayThreshold},
			#{accounttype},
			#{year},
			#{month}
		)
	</insert>
	
	<update id="update">
		UPDATE settlement_accnt_eom_balance SET 	
			id = #{id},
			accountid = #{accountid},
			accountname = #{accountname},
			hotelid = #{hotelid},
			hotelname = #{hotelname},
			hotelpms = #{hotelpms},
			password = #{password},
			accountstate = #{accountstate},
			frozendate = #{frozendate},
			unfrozendate = #{unfrozendate},
			balance = #{balance},
			create_time = #{createTime},
			update_time = #{updateTime},
			accountrole = #{accountrole},
			waitpayment = #{waitpayment},
			postpay_balance = #{postpayBalance},
			postpay_threshold = #{postpayThreshold},
			accounttype = #{accounttype},
			year = #{year},
			month = #{month}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		DELETE FROM settlement_accnt_eom_balance
		WHERE id = #{id}
	</update>
	
</mapper>